# NJIT-Summer-Research
Tracking the effect of temperature on the amplitude of a filament using Image Processing and Fourier Decomposition. This research involves observing the motion of microtubules that are stabilized with Taxol. Knowing the ideal temperature to run the experiment (where the microtubule is the most stable), enables us to determine the bounds at which the microtubule is most stable for running future experiments and even chemotherapy in the future. This was done by determining the amplitude and frequency of the motion of the microtubule, we had to process the microtubule the microtubule with a filament tracking algorithm (vision tracking done with FIJI and Matlab analysis). 

# Individual Contributions
Last summer, I did data analysis research in biophysics that employed the use of MATLAB in NJIT. This project involves observing the motion of microtubules that are stabilized with Taxol, a chemotherapy drug that prevents the polymerization and depolymerization of the microtubule. Prior to the experiment, the temperature of the microtubules was not fully controlled. Knowing the ideal temperature to run the experiment (where the microtubule is the most stable), enables us to determine the bounds at which the microtubule is most stable for running future experiments and even chemotherapy. In order to determine the amplitude and frequency of the motion of the microtubule, we had to process the microtubule with a filament tracking algorithm. This filament tracking algorithm relied on an ImageJ plugin called JFilament that skeletonized the microtubule and determined the position of the microtubule in each frame. From there, we filter the microtubule using a mean and a Gaussian filter in order to smooth the background of the microtubule and increase the contrast of the microtubule. This is followed by filament reconstruction algorithm that enables us to rotate portions of the microtubule in order to make it horizontal. This allows the algorithm to fit a Gaussian Intensity Profile to the intensities of the microtubule in order to attain subpixel resolution. Finally, a Fourier Transform is done with the shape of the microtubules to determine the amplitude of the microtubule in each frame. Comparing the mean amplitude and the variance in amplitude in each temperature allowed us to determine that there is too much noise in the image above 37ºC and not enough energy for motion below 20ºC. Thus the temperature during our further experiments needs to be controlled between these two temperatures to attain the best accuracy in the tracking of the microtubule over time. Below, I have included the procedure for our image processing in JFilament (a vision processing plugin) and an overview of the run of our Filament Tracking Algorithm from our paper.

For the Image Processing , we began by importing a video of the microtubule or other filament as a tiff stack. Then we smoothed the image to blur the background of the image. This followed by opening the JFilament plugin and marking the location of the microtubule (or other filament) in the first frame of the video. Then the parameters for the JFilament plugin were set as follows: Alpha = 15, Beta = 10, Gamma = 400, Weight = 0.5, Stretch Force = 100, Deform Iterations = 1000, Point Spacing = 2, Image Smoothing = 1.01. We then deformed the model curve that represents the position of the filament in the first frame to match the position of the filament in the second frame. This process was repeated for the next frames by a tracking algorithm present in the plugin. The set of points that show where the microtubule is called the skeletonization.

We then exported the JFilament skeletonization (as a matrix of points) and the original video of the microtubules as a tiff stack to the Filament Tracking Algorithm. We also initialized the parameters of the number of pictures to process using user input. The algorithm runs as follows. A nearest neighbor algorithm ensures that each frame has the same number of points. This algorithm determines the maximum number of points in the whole matrix. Then starting from that frame it assigns a point of the previous frame to the closest point of the current frame. The points of the algorithm are reorganized to then show the motion of a point over time. If there are not the same number of points in the previous frame as the current frame, the points that are not currently associated with a point in the previous frame are copied over to the previous frame. This process is repeated so that each frame has the same number of points and so that each point in the skeletonization is associated with a point in the previous frame. Filtration then occurs in the code with the specified diameter for the mean filter and the standard deviation for the Gaussian filter. The final filtered image is the subtraction of the mean filtered image from the Gaussian filtered image. The Filament Reconstruction Algorithm follows this filtration where a spline fit is done on the points from the skeletonization. The spline is differentiated to determine the tangent line to the curve of the microtubules. From this, the angle of rotation can be determined to make a segment of the microtubule horizontal. Using this horizontal segment a Gaussian intensity plot profile could be plotted in order to determine the position of the microtubule in subpixel resolution. Finally, a Fourier transform is performed on the microtubule. This enables the algorithm to determine the mode amplitude of the microtubule's movement.
